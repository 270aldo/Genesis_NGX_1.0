meta {
  name: Sign Up
  type: http
  seq: 1
}

post {
  url: {{base_url}}/auth/signup
  body: json
}

headers {
  Content-Type: application/json
}

body:json {
  {
    "email": "{{test_user_email}}",
    "password": "{{test_user_password}}",
    "first_name": "Test",
    "last_name": "User"
  }
}

tests {
  test("Sign up accepts valid registration data", function() {
    expect([201, 400, 409]).to.include(res.getStatus());
  });

  test("Sign up response has correct structure", function() {
    const body = res.getBody();
    if (res.getStatus() === 201) {
      expect(body).to.have.property('user');
      expect(body).to.have.property('message');
      expect(body.user).to.have.property('id');
      expect(body.user).to.have.property('email');
    }
  });

  test("Password is not returned in response", function() {
    const body = res.getBody();
    if (res.getStatus() === 201) {
      expect(body.user).to.not.have.property('password');
    }
  });
}
